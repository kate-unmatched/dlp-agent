# DLP-–ê–≥–µ–Ω—Ç
A lightweight software module that monitors certain user actions in real time, extracts formalized features from them and transmits them to a central analysis system.

```
dlp_agent/
‚îú‚îÄ‚îÄ agent.py
‚îú‚îÄ‚îÄ config.py
‚îú‚îÄ‚îÄ features/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ file_features.py         # –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ
‚îÇ   ‚îî‚îÄ‚îÄ network_features.py      # –ú–µ—Ç—Ä–∏–∫–∏ —Å–µ—Ç–µ–≤–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ triggers/
‚îÇ   ‚îî‚îÄ‚îÄ check_triggers.py        # –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îî‚îÄ‚îÄ system.py                # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
```
# –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö, —Å–æ–±–∏—Ä–∞–µ–º—ã—Ö DLP-–∞–≥–µ–Ω—Ç–æ–º –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ –æ—Ü–µ–Ω–∫–∏ —Ä–∏—Å–∫–∞.

---

## 1. –§–∞–π–ª–æ–≤–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

| –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∞                | –¢–∏–ø    | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------------------------------|--------|----------|
| `file_create_count`              | int    | –ö–æ–ª-–≤–æ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –∑–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª |
| `file_delete_count`              | int    | –ö–æ–ª-–≤–æ —É–¥–∞–ª—ë–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ |
| `file_copy_count`                | int    | –ö–æ–ª-–≤–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ |
| `file_rename_count`              | int    | –ö–æ–ª-–≤–æ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ |
| `file_access_sensitive_docs`     | bool   | –ë—ã–ª–∏ –ª–∏ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ .doc/.xls/.pdf |
| `file_sensitive_word_matches`    | int    | –ö–æ–ª-–≤–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π —Å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º–∏ —Å–ª–æ–≤–∞–º–∏ |
| `file_contains_card_number`      | bool   | –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –Ω–æ–º–µ—Ä–∞ –∫–∞—Ä—Ç |
| `file_contains_passport_data`    | bool   | –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –ø–∞—Å–ø–æ—Ä—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ |
| `total_data_written_MB`          | float  | –û–±—â–∏–π –æ–±—ä—ë–º –∑–∞–ø–∏—Å–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö |
| `usb_file_copy_count`            | int    | –§–∞–π–ª—ã, —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞ USB |

---

## 2. –°–µ—Ç–µ–≤–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

| –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∞                      | –¢–∏–ø     | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------------------------------------|----------|----------|
| `http_requests_count`                 | int      | –ö–æ–ª-–≤–æ HTTP/HTTPS-–∑–∞–ø—Ä–æ—Å–æ–≤ –∑–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª |
| `upload_volume_MB`                   | float    | –û–±—ä—ë–º –∏—Å—Ö–æ–¥—è—â–µ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ –≤ –º–µ–≥–∞–±–∞–π—Ç–∞—Ö |
| `distinct_domains_accessed`          | int      | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –¥–æ–º–µ–Ω–Ω—ã—Ö –∏–º—ë–Ω |
| `visited_webmail`                    | bool     | –ü–æ—Å–µ—â–∞–ª–∏—Å—å –ª–∏ –≤–µ–±-–ø–æ—á—Ç—ã (mail.ru, gmail, yandex –∏ —Ç.–¥.) |
| `visited_file_sharing_site`          | bool     | –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –ª–∏ —Å–∞–π—Ç—ã —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤ (Google Drive, Dropbox –∏ –¥—Ä.) |
| `vpn_activated`                      | bool     | –í —Å–∏—Å—Ç–µ–º–µ –∑–∞–ø—É—â–µ–Ω VPN-–∫–ª–∏–µ–Ω—Ç –∏–ª–∏ —Ç—É–Ω–Ω–µ–ª—å |
| `proxy_used`                         | bool     | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä –∏–ª–∏ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø—Ä–æ–∫—Å–∏-–ø–æ—Ä—Ç |
| `external_ip_contacted`              | int      | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π —Å –≤–Ω–µ—à–Ω–∏–º–∏ IP-–∞–¥—Ä–µ—Å–∞–º–∏ |
| `site_contains_sensitive_words`      | bool     | –í –∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö –∏–ª–∏ —Ç–µ–ª–µ —Å–∞–π—Ç–æ–≤ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Ä–º–∏–Ω—ã |
| `dns_request_count`                  | int      | –ö–æ–ª-–≤–æ DNS-–∑–∞–ø—Ä–æ—Å–æ–≤, —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–æ–π |
| `suspicious_dns_queries`             | bool     | –ë—ã–ª–∏ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–º –∏–ª–∏ —Ç—É–Ω–Ω–µ–ª—å–Ω—ã–º –¥–æ–º–µ–Ω–∞–º |
| `non_http_traffic_count`             | int      | –ö–æ–ª-–≤–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –Ω–µ –ø–æ HTTP/HTTPS (–Ω–∞–ø—Ä–∏–º–µ—Ä, FTP, SSH, SMTP) |
| `used_ftp_or_smtp`                   | bool     | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∞ –ø–µ—Ä–µ–¥–∞—á–∞ —á–µ—Ä–µ–∑ FTP –∏–ª–∏ SMTP |
| `upload_spike_detected`              | bool     | –†–µ–∑–∫–∏–π —Ä–æ—Å—Ç –∏—Å—Ö–æ–¥—è—â–µ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ –∑–∞ –º–∞–ª—ã–π –ø—Ä–æ–º–µ–∂—É—Ç–æ–∫ –≤—Ä–µ–º–µ–Ω–∏ |
| `visited_risky_category_sites`       | int      | –ö–æ–ª-–≤–æ –ø–æ—Å–µ—â—ë–Ω–Ω—ã—Ö —Å–∞–π—Ç–æ–≤ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–π: —Ñ–∞–π–ª–æ–æ–±–º–µ–Ω, webmail, –ø—Ä–æ–∫—Å–∏, darknet |
| `site_category_diversity`            | int      | –ö–æ–ª-–≤–æ —Ä–∞–∑–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Å–∞–π—Ç–æ–≤ –∑–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª |
| `external_upload_without_web_activity` | bool   | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∞ –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤ –±—Ä–∞—É–∑–µ—Ä–µ |

---

## 3. –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∏ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∫–æ–º–∞–Ω–¥

| –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∞                | –¢–∏–ø    | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------------------------------|--------|----------|
| `process_count`                 | int    | –û–±—â–µ–µ —á–∏—Å–ª–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ |
| `unknown_processes_started`     | int    | –ó–∞–ø—É—â–µ–Ω—ã –Ω–µ—Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã |
| `admin_tools_used`              | bool   | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å —Å—Ä–µ–¥—Å—Ç–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è |
| `time_in_terminal_sec`          | int    | –í—Ä–µ–º—è –≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ / PowerShell |
| `automation_tool_detected`      | bool   | AutoHotKey, Selenium –∏ –¥—Ä. |
| `screen_capture_tools_used`     | bool   | –ó–∞–ø—É—Å–∫ —Å—Ä–µ–¥—Å—Ç–≤ –∑–∞—Ö–≤–∞—Ç–∞ —ç–∫—Ä–∞–Ω–∞ |

---

## 4. –ü–æ–≤–µ–¥–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

| –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∞                | –¢–∏–ø    | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------------------------------|--------|----------|
| `keyboard_input_events`          | int    | –ö–æ–ª-–≤–æ –Ω–∞–∂–∞—Ç–∏–π –∫–ª–∞–≤–∏—à |
| `mouse_clicks`                   | int    | –ö–æ–ª-–≤–æ –∫–ª–∏–∫–æ–≤ –º—ã—à–∏ |
| `active_window_changes`          | int    | –ö–æ–ª-–≤–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–π –æ–∫–æ–Ω |
| `clipboard_contains_sensitive_data` | bool | –í –±—É—Ñ–µ—Ä–µ ‚Äî –Ω–æ–º–µ—Ä–∞, e-mail, –ø–∞—Ä–æ–ª–∏ |
| `copy_paste_activity_count`      | int    | –ö–æ–ª-–≤–æ –æ–ø–µ—Ä–∞—Ü–∏–π –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è/–≤—Å—Ç–∞–≤–∫–∏ |

---

## 5. –í–Ω–µ—à–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

| –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∞                | –¢–∏–ø    | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------------------------------|--------|----------|
| `usb_devices_connected`          | int    | –ö–æ–ª-–≤–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π USB |
| `usb_vendor_blacklisted`         | bool   | –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∏–∑ —á—ë—Ä–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ |
| `usb_copy_volume_MB`             | float  | –û–±—ä—ë–º –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ USB |
| `usb_last_vendor`                | str    | –ü–æ—Å–ª–µ–¥–Ω–∏–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä USB-—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ |

---

## üïí 6. –í—Ä–µ–º–µ–Ω–Ω–æ–π –∏ –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç

| –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∞                | –¢–∏–ø    | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------------------------------|--------|----------|
| `hour_of_day`                    | int    | –ß–∞—Å —Å—É—Ç–æ–∫ (0‚Äì23) |
| `activity_outside_work_hours`   | bool   | –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤–Ω–µ —Ä–∞–±–æ—á–∏—Ö —á–∞—Å–æ–≤ |
| `login_time_sec`                | int    | –í—Ä–µ–º—è –≤—Ö–æ–¥–∞ –≤ —Å–∏—Å—Ç–µ–º—É |
| `time_since_last_activity_sec`  | int    | –ü–∞—É–∑–∞ –ø–µ—Ä–µ–¥ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é (–≤ —Å–µ–∫—É–Ω–¥–∞—Ö) |

---

## 7. –¢—Ä–∏–≥–≥–µ—Ä—ã (—Å–æ–±—ã—Ç–∏–π–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã)

> –≠—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–∏ —Ñ–∏–∫—Å–∏—Ä—É—é—Ç—Å—è –ø–æ —Ñ–∞–∫—Ç—É —Å–æ–±—ã—Ç–∏—è, –∏–Ω–∏—Ü–∏–∏—Ä—É—é—Ç –Ω–µ–º–µ–¥–ª–µ–Ω–Ω—É—é –æ—Ç–ø—Ä–∞–≤–∫—É.

| –ù–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–∏–≥–≥–µ—Ä–∞                 | –¢–∏–ø    | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------------------------------|--------|----------|
| `usb_connected`                 | bool   | –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ USB-–Ω–∞–∫–æ–ø–∏—Ç–µ–ª—è |
| `vpn_activated`                 | bool   | –û–±–Ω–∞—Ä—É–∂–µ–Ω –∑–∞–ø—É—Å–∫ VPN-–∫–ª–∏–µ–Ω—Ç–∞ –∏–ª–∏ —Ç—É–Ω–Ω–µ–ª—è |
| `proxy_config_changed`         | bool   | –ò–∑–º–µ–Ω–µ–Ω—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–∫—Å–∏ –∏–ª–∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ |
| `disable_antivirus`            | bool   | –û—Ç–∫–ª—é—á—ë–Ω –∞–Ω—Ç–∏–≤–∏—Ä—É—Å –∏–ª–∏ –∑–∞—â–∏—Ç–Ω–æ–µ –ü–û |
| `mass_file_actions`            | bool   | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ –±–æ–ª—å—à–æ–µ —á–∏—Å–ª–æ –æ–ø–µ—Ä–∞—Ü–∏–π —Å —Ñ–∞–π–ª–∞–º–∏ –∑–∞ –∫–æ—Ä–æ—Ç–∫–æ–µ –≤—Ä–µ–º—è |
| `unknown_exe_started`          | bool   | –ó–∞–ø—É—â–µ–Ω –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª –≤–Ω–µ –±–µ–ª–æ–≥–æ —Å–ø–∏—Å–∫–∞ |
| `ftp_activity_detected`        | bool   | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ FTP-–ø—Ä–æ—Ç–æ–∫–æ–ª—É |
| `smtp_activity_detected`       | bool   | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ SMTP |
| `non_http_upload_detected`     | bool   | –ò—Å—Ö–æ–¥—è—â–∏–π —Ç—Ä–∞—Ñ–∏–∫ –±–µ–∑ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –±—Ä–∞—É–∑–µ—Ä–∞ |
| `access_to_blacklisted_site`   | bool   | –ü–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∑–∞–ø—Ä–µ—â—ë–Ω–Ω–æ–º—É —Å–∞–π—Ç—É |
| `screenshot_tool_detected`     | bool   | –û–±–Ω–∞—Ä—É–∂–µ–Ω –∑–∞–ø—É—Å–∫ –ø—Ä–æ–≥—Ä–∞–º–º –∑–∞—Ö–≤–∞—Ç–∞ —ç–∫—Ä–∞–Ω–∞ |
| `sensitive_doc_opened`         | bool   | –û—Ç–∫—Ä—ã—Ç –¥–æ–∫—É–º–µ–Ω—Ç, –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–∞–∫ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π |
| `clipboard_sensitive_data`     | bool   | –í –±—É—Ñ–µ—Ä–µ –æ–±–º–µ–Ω–∞ ‚Äî –ò–ù–ù, –∫–∞—Ä—Ç—ã, –ø–∞—Ä–æ–ª–∏ –∏ —Ç.–ø. |
| `explorer_archiving_detected`  | bool   | –°–æ–∑–¥–∞–Ω–∏–µ –∏–ª–∏ —É–ø–∞–∫–æ–≤–∫–∞ –±–æ–ª—å—à–æ–≥–æ –∞—Ä—Ö–∏–≤–∞ |
| `process_spike_detected`       | bool   | –†–µ–∑–∫–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (–≤–æ–∑–º–æ–∂–Ω–æ, –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è) |

---

## –§–æ—Ä–º–∞—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å (–ø—Ä–∏–º–µ—Ä)

```json
{
  "user_id": "user42",
  "timestamp": "2025-05-01T22:00:00",
  "features": {
    "file_create_count": 4,
    "http_requests_count": 37,
    "vpn_activated": 1,
    "...": "..."
  },
  "trigger": "vpn_activated"
}
